(window.webpackJsonp=window.webpackJsonp||[]).push([[18],{506:function(s,t,a){"use strict";a.r(t);var e=a(4),n=Object(e.a)({},(function(){var s=this,t=s.$createElement,a=s._self._c||t;return a("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[a("h1",{attrs:{id:"ffmpeg"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#ffmpeg"}},[s._v("#")]),s._v(" FFmpeg")]),s._v(" "),a("h2",{attrs:{id:"安装"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#安装"}},[s._v("#")]),s._v(" 安装")]),s._v(" "),a("p",[s._v("windows：网上找个包，不需要安装，直接把安装目录下的/bin 路径添加到系统 PATH 路径即可。")]),s._v(" "),a("p",[s._v("百度云获取："),a("a",{attrs:{href:"https://pan.baidu.com/s/1CGAU4S8PO_ObH7fVvRwpoQ",target:"_blank",rel:"noopener noreferrer"}},[s._v("click me"),a("OutboundLink")],1),s._v("\n提取码：zszd")]),s._v(" "),a("h2",{attrs:{id:"常用命令"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#常用命令"}},[s._v("#")]),s._v(" 常用命令")]),s._v(" "),a("div",{staticClass:"language-shell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[s._v("ffmpeg "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("global_options"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("input_file_options"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" -i input_url"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("..")]),s._v(". "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("output_file_options"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" output_url"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("..")]),s._v(".\n\nffmpeg -i "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("输入文件名"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("参数选项"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" -f "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("格式"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("输出文件"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n\n参数选项：\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" -an: 去掉音频\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" -vn: 去掉视频\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("3")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" -acodec: 设定音频的编码器，未设定时则使用与输入流相同的编解码器。音频解复用在一般后面加copy表示拷贝\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("4")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" -vcodec: 设定视频的编码器，未设定时则使用与输入流相同的编解码器，视频解复用一般后面加copy表示拷贝\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("5")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" –f: 输出格式（视频转码）\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("6")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" -bf: B帧数目控制\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("7")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" -g: 关键帧间隔控制"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("视频跳转需要关键帧"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("8")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" -s: 设定画面的宽和高，分辨率控制"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("352")]),s._v("*278"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("9")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" -i:  设定输入流\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("10")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" -ss: 指定开始时间（0:0:05）\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("11")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" -t: 指定持续时间（0:05）\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("12")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" -b: 设定视频流量，默认是200Kbit/s\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("13")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" -aspect: 设定画面的比例\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("14")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" -ar: 设定音频采样率\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("15")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" -ac: 设定声音的Channel数\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("16")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("  -r: 提取图像频率（用于视频截图）\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("17")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" -c:v:  输出视频格式\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("18")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" -c:a:  输出音频格式\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("18")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" -y:  输出时覆盖输出目录已存在的同名文件\n\n\n-vcoder 设定视频的编码器，未设定时则使用与输入流相同的编解码器\n")])])]),a("h3",{attrs:{id:"常用的对视频的操作"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#常用的对视频的操作"}},[s._v("#")]),s._v(" 常用的对视频的操作")]),s._v(" "),a("ul",[a("li",[s._v("简单例子")])]),s._v(" "),a("div",{staticClass:"language-shell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[s._v("$ ffmpeg -i input.mp4 output.avi\n"),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(". -i 输入文件路径\n"),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v(". 命令行最后是输出文件路径\n")])])]),a("ul",[a("li",[s._v("修改视频帧率")])]),s._v(" "),a("div",{staticClass:"language-shell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[s._v("$ ffmpeg -i input.avi -r "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("24")]),s._v(" output.avi  // 强制把输出视频文件帧率改为 "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("24")]),s._v(" fps:\n-r 帧率\n")])])]),a("ul",[a("li",[s._v("截图")])]),s._v(" "),a("div",{staticClass:"language-shell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[s._v("$ ffmpeg -i input_file -y -f image2 -t "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.001")]),s._v(" -s 352x240 output.jpg\n")])])]),a("ul",[a("li",[s._v("把视频的前 30 帧转换成一个 Animated Gif")])]),s._v(" "),a("div",{staticClass:"language-shell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[s._v("ffmpeg -i input_file -vframes "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("30")]),s._v(" -y -f gif output.gif\n")])])]),a("ul",[a("li",[s._v("在视频的第 8.01 秒出截取 230x240 的缩略图")])]),s._v(" "),a("div",{staticClass:"language-shell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[s._v("ffmpeg -i input_file -y -f mjpeg -ss "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("8")]),s._v(" -t "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.001")]),s._v(" -s 320x240 output.jpg\n")])])]),a("ul",[a("li",[s._v("每隔一秒截一张图")])]),s._v(" "),a("div",{staticClass:"language-shell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[s._v("ffmpeg -i out.mp4 -f image2 -vf "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("fps")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("fps"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(" out%d.png\n")])])]),a("ul",[a("li",[s._v("每隔 20 秒截一张图")])]),s._v(" "),a("div",{staticClass:"language-shell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[s._v("ffmpeg -i out.mp4 -f image2 -vf "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("fps")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("fps"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("/20 out%d.png\n")])])]),a("ul",[a("li",[s._v("从视频中生成 GIF 图片")])]),s._v(" "),a("div",{staticClass:"language-shell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[s._v("ffmpeg -i out.mp4 -t "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("10")]),s._v(" -pix_fmt rgb24 out.gif\n")])])]),a("ul",[a("li",[s._v("从视频截选指定长度的内容生成 GIF 图片")])]),s._v(" "),a("div",{staticClass:"language-shell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[s._v("ffmpeg -ss "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("3")]),s._v(" -t "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("5")]),s._v(" -i input.mp4 -s "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("480")]),s._v("*270 -f gif out.gif\n")])])]),a("ul",[a("li",[s._v("转换视频为图片（每帧一张图）")])]),s._v(" "),a("div",{staticClass:"language-shell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[s._v("ffmpeg -i out.mp4 out%4d.png\n")])])]),a("ul",[a("li",[s._v("图片转换为视频")])]),s._v(" "),a("div",{staticClass:"language-shell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[s._v("ffmpeg -f image2 -i out%4d.png -r "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("25")]),s._v(" video.mp4\n")])])]),a("ul",[a("li",[s._v("切分视频并生成 M3U8 文件")])]),s._v(" "),a("div",{staticClass:"language-shell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[s._v("ffmpeg -i input.mp4 -c:v libx264 -c:a aac -strict -2 -f hls -hls_time "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("20")]),s._v(" -hls_list_size "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(" -hls_wrap "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(" output.m3u8\n")])])]),a("ul",[a("li",[s._v("分离视频音频流")])]),s._v(" "),a("div",{staticClass:"language-shell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[s._v("ffmpeg -i input_file -vcodec copy -an output_file_video    //分离视频流\nffmpeg -i input_file -acodec copy -vn output_file_audio    //分离音频流\n")])])]),a("ul",[a("li",[s._v("视频转码")])]),s._v(" "),a("div",{staticClass:"language-shell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[s._v("ffmpeg -i test.mp4 -vcoder h264 -s "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("352")]),s._v("*278 -an -f m4v test.264    //转码为码流原始文件\nffmpeg -i test.mp4 -vcoder h264 -bf "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(" -g "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("25")]),s._v(" -s "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("352")]),s._v("-278 -an -f m4v test.264    //转码为码流原始文件\nffmpeg -i test.avi -vcoder mpeg4 -vtag xvid -qsame test_xvid.avi    //转码为封装文件 -bf B帧数目控制, -g 关键帧间隔控制, -s 分辨率控制\n")])])]),a("ul",[a("li",[s._v("视频封装")])]),s._v(" "),a("div",{staticClass:"language-shell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[s._v("ffmpeg -i video_file -i audio_file -vcoder copy -acodec copy output_file\n")])])]),a("ul",[a("li",[s._v("视频剪切")])]),s._v(" "),a("div",{staticClass:"language-shell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[s._v("ffmpeg -i test.avi -r "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(" -f image2 image.jpeg //视频截图\nffmpeg -i input.avi -ss "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(":1:30 -t "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(":0:20 -vcoder copy -acoder copy output.avi //剪切视频 -r 提取图像频率， -ss 开始时间， -t 持续时间\n")])])]),a("ul",[a("li",[s._v("视频录制")])]),s._v(" "),a("div",{staticClass:"language-shell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[s._v("ffmpeg -i rtsp://hostname/test -vcoder copy out.avi\n")])])]),a("ul",[a("li",[s._v("内容反转（reverse）")])]),s._v(" "),a("div",{staticClass:"language-shell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[s._v("// For video only\nffmpeg -i input-file.mp4 -vf reverse output.mp4\n\n// For audio and video:\nffmpeg -i input-file.mp4 -vf reverse -af areverse output.mp4\n\n")])])]),a("h2",{attrs:{id:"参考"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#参考"}},[s._v("#")]),s._v(" 参考")]),s._v(" "),a("ul",[a("li",[a("a",{attrs:{href:"https://ffmpeg.org/ffmpeg.html",target:"_blank",rel:"noopener noreferrer"}},[s._v("官方文档"),a("OutboundLink")],1)]),s._v(" "),a("li",[a("a",{attrs:{href:"https://zhuanlan.zhihu.com/p/46903150",target:"_blank",rel:"noopener noreferrer"}},[s._v("FFMPEG 常用命令"),a("OutboundLink")],1)]),s._v(" "),a("li",[a("a",{attrs:{href:"https://blog.csdn.net/leixiaohua1020/category_1360795.html",target:"_blank",rel:"noopener noreferrer"}},[s._v("雷霄骅csdn专栏"),a("OutboundLink")],1)])])])}),[],!1,null,null,null);t.default=n.exports}}]);